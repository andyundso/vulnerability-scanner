class AddVulnerabilityTable < ActiveRecord::Migration[5.0]
  def change

    create_table :vul_vulnerabilities do |t|
      t.string :cve_id
      t.text :summary
      t.datetime :published_datetime
      t.datetime :last_modified_datetime
      t.timestamps

      t.float :cvss_score
      t.string :cvss_access_vector
      t.string :cvss_access_complexity
      t.string :cvss_authentication
      t.string :cvss_confidentiality_impact
      t.string :cvss_integrity_impact
      t.string :cvss_availability_impact
      t.datetime :cvss_generated_on_datetime
    end

    add_index :vul_vulnerabilities, :cve_id, :unique => true

    create_table :vul_import_logs do |t|
      t.integer :import_job_id
      t.integer :vulnerability_id
      t.integer :action
      t.timestamps
    end
  end
end
