<h1>Details about <%= @vulnerability.cve_id %></h1>
<div class="grid">
  <div class="grid-item 12/12">
    <b><%= I18n.t 'vul.vulnerability.show.summary' %>: </b><%= @vulnerability.summary %>
  </div>
</div>

<br>

<div class="grid">
  <% if @vulnerability.cvss_score %>
    <div class="grid-item 6/12">
      <h2><%= I18n.t 'vul.vulnerability.show.cvss.title' %></h2>

      <div class="grid">
        <div class="grid-item 6/12">
          <b><%= I18n.t 'vul.vulnerability.show.cvss.score' %>: </b><br>
          <b><%= I18n.t 'vul.vulnerability.show.cvss.access-vector' %>: </b><br>
          <b><%= I18n.t 'vul.vulnerability.show.cvss.access-complexity' %>: </b><br>
          <b><%= I18n.t 'vul.vulnerability.show.cvss.authentication' %>: </b><br>
          <b><%= I18n.t 'vul.vulnerability.show.cvss.confidentiality-impact' %>: </b><br>
          <b><%= I18n.t 'vul.vulnerability.show.cvss.integrity-impact' %>: </b><br>
          <b><%= I18n.t 'vul.vulnerability.show.cvss.availability-impact' %>: </b><br>
          <b><%= I18n.t 'vul.vulnerability.show.cvss.generation-date' %>: </b>
        </div>

        <div class="grid-item 6/12">
          <%= @vulnerability.cvss_score %><br>
          <%= @vulnerability.cvss_access_vector %><br>
          <%= @vulnerability.cvss_access_complexity %><br>
          <%= @vulnerability.cvss_authentication %><br>
          <%= @vulnerability.cvss_confidentiality_impact %><br>
          <%= @vulnerability.cvss_integrity_impact %><br>
          <%= @vulnerability.cvss_availability_impact %><br>
          <%= I18n.l @vulnerability.cvss_generated_on_datetime %>
        </div>
      </div>
    </div>
  <% end %>

  <div class="grid-item 6/12">
    <h2><%= I18n.t 'vul.vulnerability.show.references.title' %></h2>
    <% @vulnerability.references.first(10).each do |ref| %>
        <a target="_blank" href="<%= ref.reference_url %>"><%= link_text(ref.reference_url) %></a><br>
    <% end %>

    <% items_to_hide = @vulnerability.references.to_a - @vulnerability.references.first(10) %>
    <% if items_to_hide.any? %>
      <b><a href="#" id="hidden_links_a"><%= I18n.t 'vul.vulnerability.show.references.link' %> (<%= items_to_hide.count %>)</a></b>
      <div id="hidden_links_div">
        <% items_to_hide.each do |ref| %>
          <a target="_blank" href="<%= ref.reference_url %>"><%= link_text(ref.reference_url) %></a><br>
        <% end %>
      </div>
    <% end %>
  </div>

<div class="grid">
  <div class="grid-item 12/12">
    <h2><%= I18n.t 'vul.vulnerability.show.affected.title' %></h2>

    <table>
      <thead>
      <tr>
        <th><%= I18n.t 'vul.vulnerability.show.affected.software' %></th>
        <th><%= I18n.t 'vul.vulnerability.show.affected.version' %></th>
        <th></th>
      </tr>
      </thead>
      <tbody>
      <% @vulnerability.versions.each do |av| %>
        <tr>
          <th><%= av.software.name %></th>
          <th><%= av.version %></th>
          <th></th>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>
</div>