class Sft::Software < ActiveRecord::Base

  self.table_name = 'sft_software'

  validates :vendor_id, :name, presence: true

  belongs_to :vendor, :class_name => 'Sft::Vendor'
  has_many :versions, :class_name => 'Sft::Version'

  def self.vulnerabilities_for(software)
    Vul::Vulnerability.joins(:versions).where('sft_versions.software_id' => software.id).uniq
  end
end