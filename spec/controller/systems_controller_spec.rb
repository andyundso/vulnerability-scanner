require 'rails_helper'

RSpec.describe SystemsController, :type => :controller do

  before(:all) do
    FactoryGirl.create(:system)
  end

  describe "GET index" do
    it "assigns @systems" do
      system = System.all
      get :index
      expect(assigns(:systems)).to eq(system)
    end

    it "renders the index template" do
      get :index
      expect(response).to render_template("index")
    end

    it 'renders a json response if called' do
      get :index, format: :json
      body = JSON.parse(response.body)
      expect(body.class).to be(Hash)
      expect(body.key?('data')).to be_truthy
      expect(body['data'].count).to eq(1)
    end
  end
end